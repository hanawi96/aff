<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gi·ªè H√†ng - V√≤ng ƒê·∫ßu Tam</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;500;600;700&family=Pacifico&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="cart.css">
</head>
<body>
    <!-- Header -->
    <header class="cart-header">
        <div class="container">
            <div class="header-content">
                <a href="index.html" class="back-btn" aria-label="Quay l·∫°i">
                    <i class="fas fa-arrow-left"></i>
                </a>
                <div class="header-title-group">
                    <h1 class="cart-title">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" style="width: 1.75rem; height: 1.75rem; display: inline-block; vertical-align: middle;">
                            <path fill-rule="evenodd" d="M7.5 6v.75H5.513c-.96 0-1.764.724-1.865 1.679l-1.263 12A1.875 1.875 0 0 0 4.25 22.5h15.5a1.875 1.875 0 0 0 1.865-2.071l-1.263-12a1.875 1.875 0 0 0-1.865-1.679H16.5V6a4.5 4.5 0 1 0-9 0ZM12 3a3 3 0 0 0-3 3v.75h6V6a3 3 0 0 0-3-3Zm-3 8.25a3 3 0 1 0 6 0v-.75a.75.75 0 0 1 1.5 0v.75a4.5 4.5 0 1 1-9 0v-.75a.75.75 0 0 1 1.5 0v.75Z" clip-rule="evenodd" />
                        </svg>
                        <span class="title-text">Gi·ªè h√†ng c·ªßa m·∫π</span>
                    </h1>
                    <span class="cart-count" id="cartCount">(0 s·∫£n ph·∫©m)</span>
                </div>
                <a href="index.html" class="continue-shopping">
                    <i class="fas fa-home"></i>
                    <span>Ti·∫øp t·ª•c mua</span>
                </a>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="cart-main">
        <div class="container">
            <div class="cart-layout">
                <!-- Left Column: Cart Items -->
                <div class="cart-items-section">
                    <!-- Skeleton Loading State -->
                    <div class="cart-skeleton" id="cartSkeleton">
                        <div class="skeleton-header">
                            <div class="skeleton-icon">üõçÔ∏è</div>
                            <div class="skeleton-text">ƒêang chu·∫©n b·ªã gi·ªè h√†ng c·ªßa m·∫π...</div>
                        </div>
                        
                        <!-- Skeleton Cart Items -->
                        <div class="skeleton-items">
                            <div class="skeleton-item">
                                <div class="skeleton-image"></div>
                                <div class="skeleton-content">
                                    <div class="skeleton-line skeleton-title"></div>
                                    <div class="skeleton-line skeleton-subtitle"></div>
                                    <div class="skeleton-line skeleton-price"></div>
                                </div>
                            </div>
                            
                            <div class="skeleton-item">
                                <div class="skeleton-image"></div>
                                <div class="skeleton-content">
                                    <div class="skeleton-line skeleton-title"></div>
                                    <div class="skeleton-line skeleton-subtitle"></div>
                                    <div class="skeleton-line skeleton-price"></div>
                                </div>
                            </div>
                            
                            <div class="skeleton-item">
                                <div class="skeleton-image"></div>
                                <div class="skeleton-content">
                                    <div class="skeleton-line skeleton-title"></div>
                                    <div class="skeleton-line skeleton-subtitle"></div>
                                    <div class="skeleton-line skeleton-price"></div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Skeleton Sections -->
                        <div class="skeleton-section">
                            <div class="skeleton-line skeleton-section-title"></div>
                            <div class="skeleton-box"></div>
                        </div>
                        
                        <div class="skeleton-section">
                            <div class="skeleton-line skeleton-section-title"></div>
                            <div class="skeleton-box"></div>
                        </div>
                    </div>
                    
                    <!-- Empty State -->
                    <div class="empty-cart hidden" id="emptyCart">
                        <div class="empty-icon">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" style="width: 5rem; height: 5rem; display: inline-block;">
                                <path fill-rule="evenodd" d="M7.5 6v.75H5.513c-.96 0-1.764.724-1.865 1.679l-1.263 12A1.875 1.875 0 0 0 4.25 22.5h15.5a1.875 1.875 0 0 0 1.865-2.071l-1.263-12a1.875 1.875 0 0 0-1.865-1.679H16.5V6a4.5 4.5 0 1 0-9 0ZM12 3a3 3 0 0 0-3 3v.75h6V6a3 3 0 0 0-3-3Zm-3 8.25a3 3 0 1 0 6 0v-.75a.75.75 0 0 1 1.5 0v.75a4.5 4.5 0 1 1-9 0v-.75a.75.75 0 0 1 1.5 0v.75Z" clip-rule="evenodd" />
                            </svg>
                            <div class="empty-sparkle">‚ú®</div>
                        </div>
                        <h2>Gi·ªè h√†ng ƒëang tr·ªëng</h2>
                        <p>H√£y th√™m nh·ªØng m√≥n qu√† y√™u th∆∞∆°ng cho b√© nh√© m·∫π!</p>
                        <a href="index.html" class="btn-primary">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" style="width: 1.125rem; height: 1.125rem; display: inline-block; vertical-align: middle;"><path d="m11.645 20.91-.007-.003-.022-.012a15.247 15.247 0 0 1-.383-.218 25.18 25.18 0 0 1-4.244-3.17C4.688 15.36 2.25 12.174 2.25 8.25 2.25 5.322 4.714 3 7.688 3A5.5 5.5 0 0 1 12 5.052 5.5 5.5 0 0 1 16.313 3c2.973 0 5.437 2.322 5.437 5.25 0 3.925-2.438 7.111-4.739 9.256a25.175 25.175 0 0 1-4.244 3.17 15.247 15.247 0 0 1-.383.219l-.022.012-.007.004-.003.001a.752.752 0 0 1-.704 0l-.003-.001Z" /></svg>
                            Kh√°m ph√° s·∫£n ph·∫©m
                        </a>
                    </div>

                    <!-- Cart Items -->
                    <div class="cart-items hidden" id="cartItems">
                        <!-- Items will be rendered here -->
                    </div>

                    <!-- Order Note Section -->
                    <div class="order-note-section hidden" id="orderNoteSection">
                        <div class="order-note-header">
                            <i class="fas fa-sticky-note"></i>
                            <h3>L∆∞u √Ω cho ƒë∆°n h√†ng</h3>
                        </div>
                        <div class="order-note-content">
                            <textarea 
                                id="orderNote" 
                                class="order-note-textarea"
                                placeholder="Nh·∫≠p l∆∞u √Ω cho shop (v√≠ d·ª•: giao gi·ªù h√†nh ch√≠nh, g·ªçi tr∆∞·ªõc khi giao...)"
                                maxlength="500"
                                rows="3"
                            ></textarea>
                            <div class="order-note-footer">
                                <span class="char-count" id="orderNoteCharCount">0/500</span>
                            </div>
                        </div>
                    </div>

                    <!-- Customer Information Section -->
                    <div class="customer-info-section hidden" id="customerInfoSection">
                        <div class="customer-info-header">
                            <i class="fas fa-user-circle"></i>
                            <h3>Th√¥ng tin ng∆∞·ªùi nh·∫≠n</h3>
                        </div>
                        
                        <!-- Phone -->
                        <div class="checkout-form-group">
                            <label class="checkout-form-label">
                                <i class="fas fa-phone"></i>
                                S·ªë ƒëi·ªán tho·∫°i<span class="required">*</span>
                            </label>
                            <input type="tel" class="checkout-form-input" id="cartPhone" placeholder="Nh·∫≠p s·ªë ƒëi·ªán tho·∫°i" required>
                        </div>
                        
                        <!-- Name -->
                        <div class="checkout-form-group">
                            <label class="checkout-form-label">
                                <i class="fas fa-user"></i>
                                H·ªç v√† t√™n<span class="required">*</span>
                            </label>
                            <input type="text" class="checkout-form-input" id="cartName" placeholder="Nh·∫≠p h·ªç v√† t√™n" required>
                        </div>
                        
                        <!-- Address Selector -->
                        <div class="checkout-form-group">
                            <label class="checkout-form-label">
                                <i class="fas fa-map-marker-alt"></i>
                                ƒê·ªãa ch·ªâ giao h√†ng<span class="required">*</span>
                            </label>
                            <div id="cartAddressSelectorContainer"></div>
                        </div>
                    </div>

                    <!-- Bundle Offer Section -->
                    <div class="bundle-offer-section hidden" id="bundleOfferSection">
                        <div class="bundle-offer-badge">
                            <i class="fas fa-gift"></i>
                            <span>∆Øu ƒë√£i ƒë·∫∑c bi·ªát</span>
                            <div class="bundle-countdown" id="bundleCountdown">
                                <i class="fas fa-clock"></i>
                                <span id="bundleCountdownText">--:--:--</span>
                            </div>
                        </div>
                        
                        <div class="bundle-offer-header">
                            <div class="bundle-offer-title">
                                <h3>Mua k√®m ƒë·ªÉ b·∫£o v·ªá b√© to√†n di·ªán h∆°n</h3>
                                <p>Th√™m b√≥ d√¢u t·∫±m ƒë·ªÉ gi∆∞·ªùng - Gi√∫p b√© ng·ªß ngon v√† an to√†n h∆°n</p>
                            </div>
                            <div class="bundle-offer-benefit">
                                <div class="benefit-tag">
                                    <i class="fas fa-shipping-fast"></i>
                                    <span>FREE SHIP</span>
                                </div>
                                <div class="benefit-text">khi mua k√®m</div>
                            </div>
                        </div>

                        <div class="bundle-products" id="bundleProducts">
                            <!-- Bundle products will be rendered here -->
                        </div>

                        <div class="bundle-offer-footer">
                            <div class="bundle-stats">
                                <i class="fas fa-users"></i>
                                <span><strong>847 m·∫π</strong> ƒë√£ mua k√®m tu·∫ßn n√†y</span>
                            </div>
                            
                        </div>
                    </div>

                    <!-- Discount Code -->
                    <div class="discount-section hidden" id="discountSection">
                        <div class="discount-header">
                            <i class="fas fa-gift"></i>
                            <h3>M√£ gi·∫£m gi√°</h3>
                        </div>
                        <div class="discount-input-group">
                            <input 
                                type="text" 
                                id="discountCode" 
                                placeholder="Nh·∫≠p m√£ gi·∫£m gi√° c·ªßa b·∫°n"
                                maxlength="20"
                            >
                            <button class="btn-apply" id="applyDiscountBtn">
                                <i class="fas fa-check"></i>
                                √Åp d·ª•ng
                            </button>
                        </div>
                        <div class="discount-result" id="discountResult"></div>
                        <div class="available-codes">
                            <p class="codes-title">üíù M√£ kh·∫£ d·ª•ng cho m·∫π:</p>
                            <div class="code-list" id="availableCodes"></div>
                            <button class="btn-view-all-codes hidden" id="viewAllCodesBtn">
                                <i class="fas fa-tags"></i>
                                Xem t·∫•t c·∫£ m√£ gi·∫£m gi√°
                            </button>
                        </div>
                    </div>

                    <!-- Payment Method -->
                    <div class="payment-section hidden" id="paymentSection">
                        <div class="payment-header">
                            <i class="fas fa-credit-card"></i>
                            <h3>Ph∆∞∆°ng th·ª©c thanh to√°n</h3>
                        </div>
                        <div class="payment-methods">
                            <div class="payment-method-item active" data-method="cod" onclick="cartPayment.selectPaymentMethod('cod')">
                                <div class="payment-method-icon">üíµ</div>
                                <div class="payment-method-info">
                                    <div class="payment-method-name">Thanh to√°n khi nh·∫≠n h√†ng</div>
                                    <div class="payment-method-desc">Thanh to√°n b·∫±ng ti·ªÅn m·∫∑t khi nh·∫≠n h√†ng</div>
                                </div>
                                <div class="payment-method-check">
                                    <i class="fas fa-check-circle"></i>
                                </div>
                            </div>
                            <div class="payment-method-item" data-method="bank" onclick="cartPayment.selectPaymentMethod('bank')">
                                <div class="payment-method-icon">üè¶</div>
                                <div class="payment-method-info">
                                    <div class="payment-method-name">Chuy·ªÉn kho·∫£n ng√¢n h√†ng</div>
                                    <div class="payment-method-desc">Chuy·ªÉn kho·∫£n tr∆∞·ªõc, giao h√†ng sau</div>
                                </div>
                                <div class="payment-method-check">
                                    <i class="fas fa-check-circle"></i>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Bank Transfer Info (Hidden by default) -->
                        <div class="bank-transfer-info hidden" id="bankTransferInfo">
                            <div class="bank-info-header">
                                <i class="fas fa-university"></i>
                                Th√¥ng tin chuy·ªÉn kho·∫£n
                            </div>
                            <div class="bank-info-content">
                                <div class="bank-info-row">
                                    <span class="bank-info-label">S·ªë ti·ªÅn c·∫ßn chuy·ªÉn:</span>
                                    <span class="bank-info-value highlight" id="bankTransferAmount">0ƒë</span>
                                </div>
                                <div class="bank-info-divider"></div>
                                <div class="bank-info-row">
                                    <span class="bank-info-label">Ng∆∞·ªùi nh·∫≠n:</span>
                                    <span class="bank-info-value">L√ä TH·ªä ANH</span>
                                </div>
                                <div class="bank-info-row">
                                    <span class="bank-info-label">Ng√¢n h√†ng:</span>
                                    <span class="bank-info-value bank-name">Techcombank</span>
                                </div>
                                <div class="bank-info-row">
                                    <span class="bank-info-label">S·ªë t√†i kho·∫£n:</span>
                                    <span class="bank-info-value">
                                        <span id="bankAccountNumber">6968969012</span>
                                        <button class="copy-btn" onclick="cartPayment.copyBankInfo('6968969012')" title="Sao ch√©p">
                                            <i class="fas fa-copy"></i>
                                        </button>
                                    </span>
                                </div>
                                <div class="bank-info-row">
                                    <span class="bank-info-label">N·ªôi dung CK:</span>
                                    <span class="bank-info-value">
                                        <span id="bankTransferNote">0386190596</span>
                                        <button class="copy-btn" onclick="cartPayment.copyBankInfo('0386190596')" title="Sao ch√©p">
                                            <i class="fas fa-copy"></i>
                                        </button>
                                    </span>
                                </div>
                            </div>
                            <div class="bank-info-note">
                                <i class="fas fa-info-circle"></i>
                                L∆∞u √Ω: Vui l√≤ng chuy·ªÉn ƒë√∫ng s·ªë ti·ªÅn v√† n·ªôi dung.
                            </div>
                            
                            <button class="bank-confirm-btn" id="cartBankConfirmBtn" onclick="cartPayment.confirmBankTransfer()">
                                <i class="fas fa-check-circle"></i>
                                X√°c nh·∫≠n ƒë√£ chuy·ªÉn kho·∫£n
                            </button>
                            <div class="bank-confirm-error hidden" id="cartBankConfirmError">
                                <i class="fas fa-exclamation-circle"></i>
                                Vui l√≤ng b·∫•m x√°c nh·∫≠n ƒë√£ chuy·ªÉn kho·∫£n
                            </div>
                        </div>
                    </div>

                    <!-- Recommended Products -->
                    <div class="recommended-section hidden" id="recommendedSection">
                        <h3>
                            <i class="fas fa-lightbulb"></i>
                            Kh√°ch h√†ng c≈©ng mua
                        </h3>
                        <div class="recommended-products" id="recommendedProducts"></div>
                    </div>
                </div>

                <!-- Right Column: Summary -->
                <div class="cart-summary-section">
                    <!-- Skeleton Summary -->
                    <div class="cart-summary-skeleton" id="cartSummarySkeleton">
                        <div class="skeleton-summary-header">
                            <div class="skeleton-line skeleton-summary-title"></div>
                        </div>
                        <div class="skeleton-summary-rows">
                            <div class="skeleton-line skeleton-summary-row"></div>
                            <div class="skeleton-line skeleton-summary-row"></div>
                            <div class="skeleton-line skeleton-summary-row"></div>
                        </div>
                        <div class="skeleton-summary-divider"></div>
                        <div class="skeleton-line skeleton-summary-total"></div>
                        <div class="skeleton-summary-button"></div>
                    </div>
                    
                    <div class="cart-summary hidden" id="cartSummary">
                        <div class="summary-header">
                            <i class="fas fa-receipt"></i>
                            <h3>T√≥m t·∫Øt ƒë∆°n h√†ng</h3>
                        </div>
                        
                        <div class="summary-content">
                            <div class="summary-row">
                                <span>T·∫°m t√≠nh <span class="item-count" id="summaryItemCount">(0 sp)</span>:</span>
                                <span class="amount" id="subtotal">0ƒë</span>
                            </div>
                            
                            <div class="summary-row">
                                <span>Ph√≠ v·∫≠n chuy·ªÉn:</span>
                                <span class="amount" id="shippingFee">30.000ƒë</span>
                            </div>
                            
                            <div class="summary-row discount-row hidden" id="freeshipRow">
                                <span>
                                    Mi·ªÖn ph√≠ v·∫≠n chuy·ªÉn <span class="discount-code-label" id="freeshipLabel"></span>:
                                </span>
                                <span class="amount discount-amount" id="freeshipAmount">-0ƒë</span>
                            </div>
                            
                            <div class="summary-row discount-row hidden" id="discountRow">
                                <span>
                                    Gi·∫£m gi√° <span class="discount-code-label" id="discountCodeLabel"></span>:
                                </span>
                                <span class="amount discount-amount" id="discountAmount">-0ƒë</span>
                            </div>
                            
                            <div class="summary-divider"></div>
                            
                            <div class="summary-row total-row">
                                <span>T·ªïng c·ªông:</span>
                                <span class="amount total-amount" id="totalAmount">0ƒë</span>
                            </div>
                            
                            <div class="checkout-submit-section-cart">
                                <div class="checkout-guarantee-badge">
                                    <i class="fas fa-shield-check"></i>
                                    <div class="guarantee-text">
                                        <span class="guarantee-main">Nh·∫≠n h√†ng ki·ªÉm tra tho·∫£i m√°i</span>
                                        <span class="guarantee-sub">Kh√¥ng ∆∞ng √Ω? Ho√†n ti·ªÅn 100%</span>
                                    </div>
                                </div>
                                <div class="checkout-total-box-cart">
                                    <div class="total-label-main-cart">ƒê·∫∂T H√ÄNG NGAY</div>
                                    <div class="total-amount-cart" id="checkoutTotal">0ƒë</div>
                                </div>
                                <button class="checkout-submit-btn-cart" id="checkoutBtn">
                                    ƒê·∫∂T H√ÄNG
                                </button>
                            </div>
                        </div>
                        
                        <div class="trust-badges">
                            <div class="badge">
                                <i class="fas fa-shield-heart"></i>
                                <span>100% Th·ªß c√¥ng</span>
                            </div>
                            <div class="badge">
                                <i class="fas fa-truck"></i>
                                <span>Giao h√†ng to√†n qu·ªëc</span>
                            </div>
                            <div class="badge">
                                <i class="fas fa-hand-holding-heart"></i>
                                <span>ƒê·ªïi tr·∫£ trong 7 ng√†y</span>
                            </div>
                        </div>
                    </div>

                    <!-- Free Shipping Progress -->
                    <div class="shipping-progress hidden" id="shippingProgress">
                        <div class="progress-header">
                            <i class="fas fa-truck"></i>
                            <span id="shippingMessage">Th√™m 230.000ƒë ƒë·ªÉ FREE SHIP</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" id="progressFill"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Toast Notification -->
    <div class="toast" id="toast"></div>

    <!-- Confirm Dialog -->
    <div class="modal-overlay hidden" id="confirmModal">
        <div class="modal-content">
            <div class="modal-header">
                <i class="fas fa-exclamation-circle"></i>
                <h3>X√°c nh·∫≠n</h3>
            </div>
            <div class="modal-body" id="confirmMessage"></div>
            <div class="modal-footer">
                <button class="btn-cancel" id="confirmCancel">H·ªßy</button>
                <button class="btn-confirm" id="confirmOk">X√°c nh·∫≠n</button>
            </div>
        </div>
    </div>

    <!-- All Discounts Modal -->
    <div class="modal-overlay hidden" id="allDiscountsModal">
        <div class="modal-content modal-large">
            <div class="modal-header">
                <i class="fas fa-tags"></i>
                <h3>T·∫•t c·∫£ m√£ gi·∫£m gi√°</h3>
                <button class="modal-close-btn" id="closeAllDiscountsModal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body modal-body-scroll">
                <div id="allDiscountsList"></div>
            </div>
        </div>
    </div>

    <!-- Contact Buttons -->
    <div id="contactButtonsContainer"></div>

    <link rel="stylesheet" href="assets/css/faq-modal.css">
    <script type="module" src="cart.js"></script>
    <script src="assets/js/faq-modal.js"></script>
    <script type="module">
        // Import and initialize address selector for cart page
        import { AddressSelector } from './assets/js/components/address-selector.js';
        
        // Wait for DOM and cart to be ready
        window.addEventListener('cartInitialized', async () => {
            const container = document.getElementById('cartAddressSelectorContainer');
            if (container && !window.cartAddressSelector) {
                window.cartAddressSelector = new AddressSelector('cartAddressSelectorContainer');
                await window.cartAddressSelector.init();
                console.log('‚úÖ Address selector initialized for cart');
            }
        });
    </script>
    <script>
        // Load contact buttons
        fetch('partials/contact-buttons.html')
            .then(response => response.text())
            .then(html => {
                const container = document.getElementById('contactButtonsContainer');
                container.innerHTML = html;
                console.log('Contact buttons loaded and scripts executed');
            })
            .catch(error => console.error('Error loading contact buttons:', error));
    </script>
</body>
</html>
