<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Check Packaging Config</title>
    <style>
        body {
            font-family: monospace;
            padding: 20px;
            background: #1e1e1e;
            color: #d4d4d4;
        }
        table {
            border-collapse: collapse;
            width: 100%;
            margin-top: 20px;
        }
        th, td {
            border: 1px solid #444;
            padding: 8px;
            text-align: left;
        }
        th {
            background: #2d2d2d;
            color: #4ec9b0;
        }
        tr:hover {
            background: #2d2d2d;
        }
        .highlight {
            background: #264f78;
            font-weight: bold;
        }
        pre {
            background: #2d2d2d;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
        }
    </style>
</head>
<body>
    <h1>üîç Check Packaging Config from Database</h1>
    <button onclick="loadData()" style="padding: 10px 20px; font-size: 16px; cursor: pointer;">Load Data</button>
    
    <div id="result"></div>

    <script>
        async function loadData() {
            const resultDiv = document.getElementById('result');
            resultDiv.innerHTML = '<p>Loading...</p>';
            
            try {
                const response = await fetch('/api?action=getPackagingConfig');
                const data = await response.json();
                
                if (data.success) {
                    // Show raw JSON
                    resultDiv.innerHTML = '<h2>Raw JSON:</h2><pre>' + JSON.stringify(data.config, null, 2) + '</pre>';
                    
                    // Show table
                    let table = '<h2>Table View:</h2><table>';
                    table += '<tr><th>ID</th><th>item_name</th><th>item_cost</th><th>is_default</th><th>display_name</th><th>category_id</th></tr>';
                    
                    data.config.forEach(item => {
                        const isPackaging = ['bag_zip', 'bag_red', 'bag_carton', 'box_carton', 'box_shipping', 'thank_card', 'paper_print', 'bang_dinh'].includes(item.item_name);
                        const rowClass = isPackaging ? 'highlight' : '';
                        table += `<tr class="${rowClass}">
                            <td>${item.id}</td>
                            <td>${item.item_name}</td>
                            <td>${item.item_cost}</td>
                            <td>${item.is_default}</td>
                            <td>${item.display_name || 'N/A'}</td>
                            <td>${item.category_id || 'N/A'}</td>
                        </tr>`;
                    });
                    table += '</table>';
                    
                    resultDiv.innerHTML += table;
                    
                    // Show packaging items only
                    const packagingItems = data.config.filter(item => 
                        ['bag_zip', 'bag_red', 'bag_carton', 'box_carton', 'box_shipping', 'thank_card', 'paper_print', 'bang_dinh'].includes(item.item_name)
                    );
                    
                    resultDiv.innerHTML += '<h2>Packaging Items Only:</h2><pre>' + JSON.stringify(packagingItems, null, 2) + '</pre>';
                    
                } else {
                    resultDiv.innerHTML = '<p style="color: red;">Error: ' + data.error + '</p>';
                }
            } catch (error) {
                resultDiv.innerHTML = '<p style="color: red;">Error: ' + error.message + '</p>';
            }
        }
        
        // Auto load on page load
        window.onload = loadData;
    </script>
</body>
</html>
