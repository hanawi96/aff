<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Address Parsing - Vietnam Abbreviations</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1200px;
            margin: 20px auto;
            padding: 20px;
        }
        .test-case {
            margin: 20px 0;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        .test-case.pass {
            background-color: #d4edda;
            border-color: #c3e6cb;
        }
        .test-case.fail {
            background-color: #f8d7da;
            border-color: #f5c6cb;
        }
        .input {
            font-weight: bold;
            color: #333;
        }
        .expected {
            color: #28a745;
        }
        .actual {
            color: #dc3545;
        }
        h1 {
            color: #333;
        }
        h2 {
            color: #666;
            margin-top: 30px;
        }
    </style>
</head>
<body>
    <h1>üß™ Test Address Parsing - Vietnam Abbreviations (100+ Patterns)</h1>
    
    <h2>Test Cases</h2>
    <div id="test-results"></div>

    <script>
        // Test cases for abbreviations across Vietnam
        const testCases = [
            // B√¨nh D∆∞∆°ng
            {
                input: "346a Hu·ª≥nh VƒÉn Lu·ªπ, p.Ph√∫ L·ª£i, tp TDM, BD",
                expected: {
                    province: "B√¨nh D∆∞∆°ng",
                    district: "Th·ªß D·∫ßu M·ªôt",
                    ward: "Ph√∫ L·ª£i"
                }
            },
            {
                input: "123 ƒê∆∞·ªùng ABC, Ph∆∞·ªùng Ph√∫ H√≤a, TDM, BD",
                expected: {
                    province: "B√¨nh D∆∞∆°ng",
                    district: "Th·ªß D·∫ßu M·ªôt",
                    ward: "Ph√∫ H√≤a"
                }
            },
            {
                input: "789 L√™ VƒÉn B, Ph∆∞·ªùng An B√¨nh, Dƒ© An, BD",
                expected: {
                    province: "B√¨nh D∆∞∆°ng",
                    district: "Dƒ© An",
                    ward: "An B√¨nh"
                }
            },
            {
                input: "555 Ho√†ng VƒÉn D, Ph∆∞·ªùng L√°i Thi√™u, Thu·∫≠n An, BD",
                expected: {
                    province: "B√¨nh D∆∞∆°ng",
                    district: "Thu·∫≠n An",
                    ward: "L√°i Thi√™u"
                }
            },
            {
                input: "777 V√µ VƒÉn F, Ph∆∞·ªùng M·ªπ Ph∆∞·ªõc, B·∫øn C√°t, B√¨nh D∆∞∆°ng",
                expected: {
                    province: "B√¨nh D∆∞∆°ng",
                    district: "B·∫øn C√°t",
                    ward: "M·ªπ Ph∆∞·ªõc"
                }
            },
            
            // ƒê·ªìng Nai
            {
                input: "100 Nguy·ªÖn √Åi Qu·ªëc, p.Tr·∫£ng D√†i, tp BH, ƒê·ªìng Nai",
                expected: {
                    province: "ƒê·ªìng Nai",
                    district: "Bi√™n H√≤a",
                    ward: "Tr·∫£ng D√†i"
                }
            },
            {
                input: "200 L√™ Du·∫©n, Ph∆∞·ªùng Xu√¢n Trung, LK, ƒê·ªìng Nai",
                expected: {
                    province: "ƒê·ªìng Nai",
                    district: "Long Kh√°nh",
                    ward: "Xu√¢n Trung"
                }
            },
            
            // Long An
            {
                input: "50 H√πng V∆∞∆°ng, p.1, tp T√¢n An, LA",
                expected: {
                    province: "Long An",
                    district: "T√¢n An",
                    ward: "1"
                }
            },
            {
                input: "75 Qu·ªëc l·ªô 50, X√£ Ph∆∞·ªõc L√Ω, CG, Long An",
                expected: {
                    province: "Long An",
                    district: "C·∫ßn Giu·ªôc",
                    ward: "Ph∆∞·ªõc L√Ω"
                }
            },
            
            // TP.HCM
            {
                input: "123 ƒêi·ªán Bi√™n Ph·ªß, p.15, Q.B/Th·∫°nh, HCM",
                expected: {
                    province: "TP.HCM",
                    district: "B√¨nh Th·∫°nh",
                    ward: "15"
                }
            },
            {
                input: "456 Quang Trung, Ph∆∞·ªùng 10, G/V·∫•p, TP.HCM",
                expected: {
                    province: "TP.HCM",
                    district: "G√≤ V·∫•p",
                    ward: "10"
                }
            },
            {
                input: "789 L√™ VƒÉn Vi·ªát, p.Hi·ªáp Ph√∫, T/ƒê·ª©c, HCM",
                expected: {
                    province: "TP.HCM",
                    district: "Th·ªß ƒê·ª©c",
                    ward: "Hi·ªáp Ph√∫"
                }
            },
            
            // H√† N·ªôi
            {
                input: "36 H√†ng B√†i, p.H√†ng B√†i, q.HK, HN",
                expected: {
                    province: "H√† N·ªôi",
                    district: "Ho√†n Ki·∫øm",
                    ward: "H√†ng B√†i"
                }
            },
            {
                input: "100 Tr·∫ßn Duy H∆∞ng, Ph∆∞·ªùng Trung H√≤a, CG, H√† N·ªôi",
                expected: {
                    province: "H√† N·ªôi",
                    district: "C·∫ßu Gi·∫•y",
                    ward: "Trung H√≤a"
                }
            },
            {
                input: "200 Nguy·ªÖn Tr√£i, p.Kh∆∞∆°ng Trung, TX, HN",
                expected: {
                    province: "H√† N·ªôi",
                    district: "Thanh Xu√¢n",
                    ward: "Kh∆∞∆°ng Trung"
                }
            },
            
            // ƒê√† N·∫µng
            {
                input: "50 Tr·∫ßn Ph√∫, p.Th·∫°ch Thang, q.HC, DN",
                expected: {
                    province: "ƒê√† N·∫µng",
                    district: "H·∫£i Ch√¢u",
                    ward: "Th·∫°ch Thang"
                }
            },
            {
                input: "100 Nguy·ªÖn VƒÉn Linh, Ph∆∞·ªùng Th·ªç Quang, ST, ƒê√† N·∫µng",
                expected: {
                    province: "ƒê√† N·∫µng",
                    district: "S∆°n Tr√†",
                    ward: "Th·ªç Quang"
                }
            },
            
            // Other major cities
            {
                input: "25 L√™ L·ª£i, p.B·∫øn Ngh√©, Q1, HCM",
                expected: {
                    province: "TP.HCM",
                    district: "Qu·∫≠n 1",
                    ward: "B·∫øn Ngh√©"
                }
            },
            {
                input: "88 Tr·∫ßn H∆∞ng ƒê·∫°o, Ph∆∞·ªùng L·ªôc Th·ªç, tp NT, Kh√°nh H√≤a",
                expected: {
                    province: "Kh√°nh H√≤a",
                    district: "Nha Trang",
                    ward: "L·ªôc Th·ªç"
                }
            },
            {
                input: "150 Nguy·ªÖn T·∫•t Th√†nh, p.Ph∆∞·ªõc H·∫£i, tp VT, BRVT",
                expected: {
                    province: "B√† R·ªãa - V≈©ng T√†u",
                    district: "V≈©ng T√†u",
                    ward: "Ph∆∞·ªõc H·∫£i"
                }
            },
            
            // ƒê·∫Øk L·∫Øk - Context-aware "tt" matching
            {
                input: "S·ªë 41, th√¥n 4 tt easup huy·ªán easup t·ªânh ƒëaklak",
                expected: {
                    province: "ƒê·∫Øk L·∫Øk",
                    district: "Ea S√∫p",
                    ward: null,
                    note: "tt easup = Th·ªã tr·∫•n Ea S√∫p (NOT Huy·ªán Th·ªß Th·ª´a)"
                }
            },
            
            // B√¨nh D∆∞∆°ng - "B·∫Øc T√¢n Uy√™n" vs "T√¢n Uy√™n" disambiguation
            {
                input: "Khu ph·ªë 3 T√¢n l·∫≠p B·∫Øc T√¢n Uy√™n B√¨nh D∆∞∆°ng",
                expected: {
                    province: "B√¨nh D∆∞∆°ng",
                    district: "B·∫Øc T√¢n Uy√™n",
                    ward: "T√¢n L·∫≠p",
                    note: "B·∫Øc T√¢n Uy√™n (NOT T√¢n Uy√™n), ward = T√¢n L·∫≠p"
                }
            }
        ];

        // Simple test function (without actual parsing logic)
        function testAddressParsing() {
            const resultsDiv = document.getElementById('test-results');
            let passCount = 0;
            let failCount = 0;

            testCases.forEach((testCase, index) => {
                const testDiv = document.createElement('div');
                testDiv.className = 'test-case';
                
                // Simulate parsing (in real implementation, call parseAddress function)
                const result = simulateParsing(testCase.input);
                
                const passed = 
                    result.province === testCase.expected.province &&
                    result.district === testCase.expected.district &&
                    result.ward === testCase.expected.ward;
                
                if (passed) {
                    passCount++;
                    testDiv.classList.add('pass');
                } else {
                    failCount++;
                    testDiv.classList.add('fail');
                }

                testDiv.innerHTML = `
                    <h3>Test Case ${index + 1}: ${passed ? '‚úÖ PASS' : '‚ùå FAIL'}</h3>
                    <p class="input"><strong>Input:</strong> ${testCase.input}</p>
                    <p class="expected"><strong>Expected:</strong> 
                        Province: ${testCase.expected.province}, 
                        District: ${testCase.expected.district}, 
                        Ward: ${testCase.expected.ward}
                    </p>
                    <p class="actual"><strong>Actual:</strong> 
                        Province: ${result.province || 'N/A'}, 
                        District: ${result.district || 'N/A'}, 
                        Ward: ${result.ward || 'N/A'}
                    </p>
                `;
                
                resultsDiv.appendChild(testDiv);
            });

            // Summary
            const summaryDiv = document.createElement('div');
            summaryDiv.style.marginTop = '30px';
            summaryDiv.style.padding = '20px';
            summaryDiv.style.backgroundColor = passCount === testCases.length ? '#d4edda' : '#fff3cd';
            summaryDiv.style.border = '2px solid ' + (passCount === testCases.length ? '#c3e6cb' : '#ffc107');
            summaryDiv.style.borderRadius = '5px';
            summaryDiv.innerHTML = `
                <h2>üìä Test Summary</h2>
                <p><strong>Total:</strong> ${testCases.length}</p>
                <p><strong>Passed:</strong> ${passCount} ‚úÖ</p>
                <p><strong>Failed:</strong> ${failCount} ‚ùå</p>
                <p><strong>Success Rate:</strong> ${((passCount / testCases.length) * 100).toFixed(1)}%</p>
            `;
            resultsDiv.appendChild(summaryDiv);
        }

        // Simulate parsing (placeholder - replace with actual logic)
        function simulateParsing(input) {
            // This is a simplified simulation
            // In real implementation, this would call the actual parseAddress function
            
            let province = null;
            let district = null;
            let ward = null;

            // Expand abbreviations
            let processed = input;
            
            // Province abbreviations
            const provinceMap = {
                'bd': 'B√¨nh D∆∞∆°ng',
                'dn': 'ƒê·ªìng Nai',
                'la': 'Long An',
                'hcm': 'TP.HCM',
                'hn': 'H√† N·ªôi',
                'brvt': 'B√† R·ªãa - V≈©ng T√†u',
                'kh√°nh h√≤a': 'Kh√°nh H√≤a',
                'ƒë√† n·∫µng': 'ƒê√† N·∫µng'
            };
            
            for (const [abbr, full] of Object.entries(provinceMap)) {
                const regex = new RegExp(`\\b${abbr}\\b`, 'gi');
                if (regex.test(processed)) {
                    province = full;
                    processed = processed.replace(regex, full);
                }
            }
            
            // District abbreviations
            const districtMap = {
                // B√¨nh D∆∞∆°ng
                'tdm': 'Th·ªß D·∫ßu M·ªôt',
                'dƒ© an': 'Dƒ© An',
                'di an': 'Dƒ© An',
                'thu·∫≠n an': 'Thu·∫≠n An',
                'thuan an': 'Thu·∫≠n An',
                'b·∫øn c√°t': 'B·∫øn C√°t',
                'ben cat': 'B·∫øn C√°t',
                't√¢n uy√™n': 'T√¢n Uy√™n',
                'tan uyen': 'T√¢n Uy√™n',
                // ƒê·ªìng Nai
                'bi√™n h√≤a': 'Bi√™n H√≤a',
                'bien hoa': 'Bi√™n H√≤a',
                'bh': 'Bi√™n H√≤a',
                'long kh√°nh': 'Long Kh√°nh',
                'long khanh': 'Long Kh√°nh',
                'lk': 'Long Kh√°nh',
                // Long An
                't√¢n an': 'T√¢n An',
                'tan an': 'T√¢n An',
                'c·∫ßn giu·ªôc': 'C·∫ßn Giu·ªôc',
                'can giuoc': 'C·∫ßn Giu·ªôc',
                'cg': 'C·∫ßn Giu·ªôc',
                // TP.HCM
                'b/th·∫°nh': 'B√¨nh Th·∫°nh',
                'b/thanh': 'B√¨nh Th·∫°nh',
                'g/v·∫•p': 'G√≤ V·∫•p',
                'g/vap': 'G√≤ V·∫•p',
                't/ƒë·ª©c': 'Th·ªß ƒê·ª©c',
                't/duc': 'Th·ªß ƒê·ª©c',
                'q1': 'Qu·∫≠n 1',
                // H√† N·ªôi
                'ho√†n ki·∫øm': 'Ho√†n Ki·∫øm',
                'hoan kiem': 'Ho√†n Ki·∫øm',
                'hk': 'Ho√†n Ki·∫øm',
                'c·∫ßu gi·∫•y': 'C·∫ßu Gi·∫•y',
                'cau giay': 'C·∫ßu Gi·∫•y',
                'thanh xu√¢n': 'Thanh Xu√¢n',
                'thanh xuan': 'Thanh Xu√¢n',
                'tx': 'Thanh Xu√¢n',
                // ƒê√† N·∫µng
                'h·∫£i ch√¢u': 'H·∫£i Ch√¢u',
                'hai chau': 'H·∫£i Ch√¢u',
                'hc': 'H·∫£i Ch√¢u',
                's∆°n tr√†': 'S∆°n Tr√†',
                'son tra': 'S∆°n Tr√†',
                'st': 'S∆°n Tr√†',
                // Other cities
                'nha trang': 'Nha Trang',
                'nt': 'Nha Trang',
                'v≈©ng t√†u': 'V≈©ng T√†u',
                'vung tau': 'V≈©ng T√†u',
                'vt': 'V≈©ng T√†u'
            };
            
            // Expand "tp X" patterns
            processed = processed.replace(/\btp\s+(\w+)/gi, (match, city) => {
                return districtMap[city.toLowerCase()] || match;
            });
            
            // Check for district matches
            for (const [abbr, full] of Object.entries(districtMap)) {
                const regex = new RegExp(`\\b${abbr.replace(/\//g, '\\/')}\\b`, 'gi');
                if (regex.test(processed)) {
                    district = full;
                    processed = processed.replace(regex, full);
                    break;
                }
            }
            
            // Extract ward from p.Name or Ph∆∞·ªùng Name
            const wardMatch = processed.match(/(?:p\.|ph∆∞·ªùng|f)\s*([A-Z√Ä-·ª∏0-9][a-z√†-·ªπ\s]*?)(?:,|$)/i);
            if (wardMatch) {
                ward = wardMatch[1].trim();
            }

            return { province, district, ward };
        }

        // Run tests on page load
        window.onload = testAddressParsing;
    </script>
</body>
</html>
